<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Todo List </title>
	<!-- CSS Import -->
	<link rel="stylesheet" href="main.css" />
	<!-- End of CSS Import -->
	<!-- Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,400;0,700;0,900;1,400&family=Montserrat:ital,wght@0,400;0,700;0,900;1,400&display=swap" rel="stylesheet">
	<!-- End of Fonts -->

	<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
</head>
<body>
	<form action="index.html">
		<button type="submit" value="Submit" class="logoutbtn">Logout</button>
	</form>
	<!-- App Wrapper -->
	<main class="app">
		<!-- Greeting -->
		<section class="greeting">
			<h2 class="title">
				What's up,&nbsp;<span id="displayName"></span>
			</h2>
			
		</section>
		<!-- End of Greeting -->
		
		<!-- New Todo -->
		<section class="create-todo">
			<h3>CREATE A TODO</h3>
			<form id="new-todo-form">
				<h4>What's on your todo?</h4>
				<input 
					type="text" 
					placeholder="e.g. Get some milk"
					name="content"
					id="content" />
				
				<h4>Pick a category</h4>
				<div class="options">
					<label>
						<input type="radio" name="category" id="category1" value="business" /> 
						<span class="bubble business"></span>
						<div>Business</div>
					</label>
					<label>
						<input type="radio" name="category" id="category2" value="personal" />
						<span class="bubble personal"></span>
						<div>Personal</div>
					</label>
				</div>

				<input type="submit" value="Add todo" />
			</form>
		</section>
		<!-- End of New Todo -->

		<!-- Todo List -->
		<section class="todo-list">
			<h3>TODO LIST</h3>
			<div class="list" id="todo-list"></div>
		</section>
		<!-- End of Todo List -->

	</main>
	<!-- End of App Wrapper -->

	<script src="firebase.js"></script>
	<script src="main.js"></script>
	<script>
		const userData = JSON.parse(localStorage.getItem('user'));
		console.log(userData);
		const fetchDisplayNameFromFirestore = async () => {
			try {
				const snapshot = await db.collection('users').get(); // เลือกคอลเล็กชันที่ต้องการดึงข้อมูล
				snapshot.forEach(doc => {
					if (doc.id === userData.uid) { // เปรียบเทียบ uid ของเอกสารกับ uid ของผู้ใช้ที่ล็อกอิน
                		const userData = doc.data().displayName; // ดึงข้อมูลผู้ใช้จากเอกสาร
                		console.log(userData); // แสดงข้อมูลผู้ใช้ในคอนโซล
						document.getElementById('displayName').textContent = userData;
            }
				});
			} catch (error) {
				console.error('Error fetching displayName:', error);
			}
		};
	
		// เรียกใช้งานฟังก์ชันดึงข้อมูล displayName
		fetchDisplayNameFromFirestore();
	</script>

</body>
</html>